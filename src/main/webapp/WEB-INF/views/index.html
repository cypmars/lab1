<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Required meta tags -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="style.css">
		<link rel="icon" type="image/png" href="img/icon.png" />

		<script src="https://code.jquery.com/jquery-3.1.1.min.js" ></script>
	</head>
	<body>
		<nav class="navbar navbar-toggleable-md navbar-light bg-gradient-iordr">
			<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<a href="#"><img src="img/logo.png" height="20px" style="margin-right:15px"></a>
			<div class="collapse navbar-collapse" id="navbarText" style="margin-top:5px;">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item active">
						<a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#">About</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#"><span class="fa fa-question-circle"></span></a>
					</li>
				</ul>
				<form class="form-inline my-2 my-lg-0" action="#">
					<input class="form-control mr-sm-2" id="address" type="text" placeholder="Search">
				</form>
				<a class="nav-link" href="#"><span class="fa fa-shopping-basket" style="color: white;"></span></a>
			</div>
		</nav>
		<div id="googleMap"></div>
		<nav class="navbar navbar-inverse bg-inverse">
			<p style="color:white"><span class="fa fa-copyright"></span> 2017 Cyprien CONNET</p>
		</nav>
		<script>
	// Note: This example requires that you consent to location sharing when
	// prompted by your browser. If you see the error "The Geolocation service
	// failed.", it means you probably did not give permission for the browser to
	// locate you.

	var map;
	var markers = new Array();

	function CenterControl(controlDiv, map) {
		// Set CSS for the control border.
		var controlUI = document.createElement('div');
		controlUI.style.backgroundColor = '#fff';
		/* IE10 Consumer Preview */
		controlUI.style.background = '-ms-linear-gradient(#ff5b3d, #ff2b66)';
		/* Mozilla Firefox */
		controlUI.style.background = ' -moz-linear-gradient(#ff5b3d, #ff2b66)';
		/* Opera */
		controlUI.style.background = '-o-linear-gradient(#ff5b3d, #ff2b66)';
		/* Webkit (Safari/Chrome 10) */
		controlUI.style.background = ' -webkit-gradient(#ff5b3d, #ff2b66)';

		/* Webkit (Chrome 11+) */
		controlUI.style.background = '-webkit-linear-gradient(#ff5b3d, #ff2b66)';

		/* W3C Markup, IE10 Release Preview */
		controlUI.style.background = 'linear-gradient(#ff5b3d, #ff2b66)';

		controlUI.style.border = '2px solid #fff';
		controlUI.style.borderRadius = '35px';
		controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
		controlUI.style.cursor = 'pointer';
		controlUI.style.marginBottom = '22px';
		controlUI.style.marginLeft = '22px';
		controlUI.style.textAlign = 'center';
		controlUI.title = 'Click to see you on the map';
		controlDiv.appendChild(controlUI);

		// Set CSS for the control interior.
		var controlText = document.createElement('div');
		controlText.style.color = 'rgb(25,25,25)';
		controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
		controlText.style.fontSize = '16px';
		controlText.style.lineHeight = '38px';
		controlText.style.paddingLeft = '18px';
		controlText.style.paddingRight = '20px';
		controlText.style.paddingTop = '15px';
		controlText.style.paddingBottom = '15px';
		controlText.innerHTML = '<img src="img/geo.png" height="30px">';
		controlUI.appendChild(controlText);

		// Setup the click event listeners: simply set the map to Chicago.
		controlUI.addEventListener('click', function() {
			geolocalisation();
		});
	}

function initMap() {
    map = new google.maps.Map(document.getElementById('googleMap'), {
    center: {lat: 43.2499728, lng: 5.3754239},
    zoom: 18
  });
  // Create the DIV to hold the control and call the CenterControl() constructor
  // passing in this DIV.
  var centerControlDiv = document.createElement('div');
  var centerControl = new CenterControl(centerControlDiv, map);

  centerControlDiv.index = 1;
  map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(centerControlDiv);
}

function geolocalisation(){
	var infoWindow;
  // Try HTML5 geolocation.
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
	infoWindow = new google.maps.InfoWindow({map: map});
      infoWindow.setPosition(pos);
      infoWindow.setContent('You are here');
      map.setCenter(pos);
      var image = 'img/here.png';
      var marker = new google.maps.Marker({
      map: map,
      position: pos,
      icon: image
		});
    }, function() {
      handleLocationError(true, infoWindow, map.getCenter());
    });
  } else {
    // Browser doesn't support Geolocation
    handleLocationError(false, infoWindow, map.getCenter());
  }
}

function handleLocationError(browserHasGeolocation, infoWindow, pos) {
  infoWindow.setPosition(pos);
  infoWindow.setContent(browserHasGeolocation ?
                        'Error: The Geolocation service failed.' :
                        'Error: Your browser doesn\'t support geolocation.');
}

function addressToMap(){
			var urlReq = 'https://maps.googleapis.com/maps/api/geocode/json?key=AIzaSyA-JZTPQtssR0xvI7leAIXgSk2qkxm8je0&address=';
			var str = $('#address').val();
			var res = str.split(" ");
			var address = ""
			for (var i=0; i< res.length; i++)
			{
				address = address+'_'+res[i];
			}
			urlReq = urlReq+address;
			jQuery.getJSON(urlReq, function (data){
					map.setCenter(data.results[0].geometry.location);
			});

}


$(document).keypress(function (e) {
    if (e.which == 13) {
			addressToMap();
    }
});

    </script>
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCxr6PYLXoAc28FZFPOi3rtcKdNmdPDx44&callback=initMap"></script>
		<!-- jQuery first, then Tether, then Bootstrap JS. -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	</body>
</html>
